<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Salesforce JWT Certificate Tool</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/internal/gui/style.css">
</head>
<body>

<h2>Generate Salesforce JWT Certificate</h2>

<form id="generateForm">
    <div>
        Name:
        <br/>
        <input name="cn" required/>
    </div>
    <div>
        Validity days:
        <br/>
        <input name="days" value="1200" />
    </div>
    <button type="submit">Generate</button>
    <div id="generateSpinner" style="display:none;">
        ⏳ Generating certificate…
    </div>
</form>

<hr/>

<h2>Existing certificates</h2>

<table>
    <thead>
    <tr>
        <th>Name</th>
        <th>Expires</th>
        <th>Days left</th>
        <th class="copywidth center">Certificate</th>
        <th class="center">Verify</th>
        <th class="copywidth center">KEYSTORE_JKS_B64</th>
        <th class="copywidth center">KEYSTORE_PASSWORD</th>
        <th class="copywidth center">SF_CLIENT_ID</th>
        <th class="copywidth center">SF_USERNAME</th>
        <th></th>
    </tr>
    </thead>
    <tbody id="certTable"></tbody>
</table>
<div id="certWarnings" style="margin-top: 1em;"></div>
<div id="expiryWarnings" style="margin-top: 1em;"></div>

<br>
<br>
<button onclick="flushLocal()" title="Flush local secrets" data-color="danger" data-variant="primary" class="delete-secret aksel-button aksel-button--danger aksel-button--small"><span class="aksel-button__icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" focusable="false" role="img" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M4.5 6.25a.75.75 0 0 0 0 1.5h.805l.876 11.384a1.75 1.75 0 0 0 1.745 1.616h8.148a1.75 1.75 0 0 0 1.745-1.616l.876-11.384h.805a.75.75 0 0 0 0-1.5h-2.75V6A2.75 2.75 0 0 0 14 3.25h-4A2.75 2.75 0 0 0 7.25 6v.25zm5.5-1.5c-.69 0-1.25.56-1.25 1.25v.25h6.5V6c0-.69-.56-1.25-1.25-1.25zm-3.19 3 .867 11.27c.01.13.118.23.249.23h8.148c.13 0 .24-.1.25-.23l.866-11.27zm3.19 2a.75.75 0 0 1 .75.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 .75-.75m4 0a.75.75 0 0 1 .75.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 .75-.75" clip-rule="evenodd"></path></svg></span><span class="aksel-label aksel-label--small">Flush Local</span></button>

<!-- Test Modal -->
<div id="testModal" class="modal">
    <div class="modal-content">
        <h3>Test certificate</h3>

        <div class="form-row">
            <label>Name:</label>
            <input id="testCn" readonly>
        </div>

        <div class="form-row">
            <label>Salesforce Client ID:</label>
            <input id="testClientId">
        </div>

        <div class="form-row">
            <label>Salesforce Username:</label>
            <input id="testUsername">
        </div>

        <div id="testResult"></div>

        <div class="modal-actions">
            <button onclick="runTest()">Test</button>
            <button onclick="closeModal()">Close</button>
        </div>
    </div>
</div>
<div id="confirmModal" class="modal">
    <div class="modal-content">
        <h3 id="confirmTitle"></h3>
        <p id="confirmMessage"></p>

        <div class="modal-actions">
            <button type="button" onclick="closeConfirmModal()">Cancel</button>
            <button type="button" id="confirmOkButton">Confirm</button>
        </div>
    </div>
</div>
<div id="toast"></div>

<script src="/internal/gui/script.js"></script>
</body>
</html>
